"use strict";(self.webpackChunkai_book_hackathon=self.webpackChunkai_book_hackathon||[]).push([[7037],{6907:(e,n,r)=>{r.d(n,{A:()=>o});r(6540);var a=r(9676),s=r(4848);const o=function(e){var n=e.children,r=e.title,o=e.description;return(0,s.jsx)(a.A,{title:r,description:o,wrapperClassName:"auth-page-layout",children:(0,s.jsx)("div",{className:"auth-page",style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#0D0D0D"},children:(0,s.jsx)("div",{style:{width:"100%",maxWidth:"500px",margin:"0 auto",padding:"2rem"},children:n})})})}},7940:(e,n,r)=>{r.d(n,{y:()=>m});var a,s,o,t,i=r(2444),c=r(467),l=r(9720),u=function(e){"undefined"!=typeof window&&localStorage.setItem("better_auth_token",e)},d=function(){"undefined"!=typeof window&&localStorage.removeItem("better_auth_token")},m={register:(t=(0,c.A)((0,i.A)().m(function e(n,r,a){var s,o,t;return(0,i.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:return console.log("Auth Service: Starting registration for email:",n),e.p=1,e.n=2,l.signUp.email({email:n,password:r,name:a});case 2:return s=e.v,console.log("Auth Service: Registration response:",s),o=null,s&&s.session&&s.session.token?o=s.session.token:s&&s.token?o=s.token:s&&s.data&&s.data.session&&s.data.session.token?o=s.data.session.token:s&&s.data&&s.data.token&&(o=s.data.token),o?(u(o),console.log("Auth Service: Token stored in localStorage")):(console.log("Auth Service: No token found in response"),console.log("Response structure:",JSON.stringify(s,null,2))),e.a(2,s);case 3:throw e.p=3,t=e.v,console.error("Registration error:",t),t;case 4:return e.a(2)}},e,null,[[1,3]])})),function(e,n,r){return t.apply(this,arguments)}),login:(o=(0,c.A)((0,i.A)().m(function e(n,r){var a,s,o;return(0,i.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:return console.log("Auth Service: Starting login for email:",n),e.p=1,e.n=2,l.signIn.email({email:n,password:r});case 2:return a=e.v,console.log("Auth Service: Login response:",a),s=null,a&&a.session&&a.session.token?s=a.session.token:a&&a.token?s=a.token:a&&a.data&&a.data.session&&a.data.session.token?s=a.data.session.token:a&&a.data&&a.data.token&&(s=a.data.token),s?(u(s),console.log("Auth Service: Token stored in localStorage")):(console.log("Auth Service: No token found in response"),console.log("Response structure:",JSON.stringify(a,null,2))),e.a(2,a);case 3:throw e.p=3,o=e.v,console.error("Login error:",o),o;case 4:return e.a(2)}},e,null,[[1,3]])})),function(e,n){return o.apply(this,arguments)}),logout:(s=(0,c.A)((0,i.A)().m(function e(){var n,r;return(0,i.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,(0,l.signOut)();case 1:return n=e.v,d(),e.a(2,n);case 2:throw e.p=2,r=e.v,console.error("Logout error:",r),r;case 3:return e.a(2)}},e,null,[[0,2]])})),function(){return s.apply(this,arguments)}),getCurrentUser:(a=(0,c.A)((0,i.A)().m(function e(){return(0,i.A)().w(function(e){for(;;)if(0===e.n)return e.a(2)},e)})),function(){return a.apply(this,arguments)})}},9720:(e,n,r)=>{r.r(n),r.d(n,{authClient:()=>u,checkSession:()=>d,signIn:()=>i,signOut:()=>l,signUp:()=>c,useSession:()=>m});var a,s,o=r(2444),t=r(467),i={email:(a=(0,t.A)((0,o.A)().m(function e(n){var r,a,s,t;return(0,o.A)().w(function(e){for(;;)switch(e.n){case 0:return r=n.email,a=n.password,e.n=1,fetch("https://nkamdar-ai-book-hackathon.hf.space/api/auth/sign-in/email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,password:a})});case 1:return s=e.v,e.n=2,s.json();case 2:if(t=e.v,!s.ok){e.n=3;break}return t.session&&t.session.token&&localStorage.setItem("better_auth_token",t.session.token),e.a(2,t);case 3:throw new Error(t.detail||"Login failed");case 4:return e.a(2)}},e)})),function(e){return a.apply(this,arguments)})},c={email:(s=(0,t.A)((0,o.A)().m(function e(n){var r,a,s,t,i;return(0,o.A)().w(function(e){for(;;)switch(e.n){case 0:return r=n.email,a=n.password,s=n.name,e.n=1,fetch("https://nkamdar-ai-book-hackathon.hf.space/api/auth/sign-up/email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,password:a,name:s||""})});case 1:return t=e.v,e.n=2,t.json();case 2:if(i=e.v,!t.ok){e.n=3;break}return i.session&&i.session.token&&localStorage.setItem("better_auth_token",i.session.token),e.a(2,i);case 3:throw new Error(i.detail||"Registration failed");case 4:return e.a(2)}},e)})),function(e){return s.apply(this,arguments)})},l=function(){var e=(0,t.A)((0,o.A)().m(function e(){var n,r;return(0,o.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:return localStorage.removeItem("better_auth_token"),e.p=1,n=process.env.NEXT_PUBLIC_API_URL||"http://localhost:8000",e.n=2,fetch(n+"/api/auth/sign-out",{method:"POST"});case 2:e.n=4;break;case 3:e.p=3,r=e.v,console.error("Sign out error:",r);case 4:return e.a(2,{success:!0})}},e,null,[[1,3]])}));return function(){return e.apply(this,arguments)}}(),u=null,d=function(){var e=(0,t.A)((0,o.A)().m(function e(){var n,r,a,s;return(0,o.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,n=localStorage.getItem("better_auth_token")||""){e.n=1;break}return console.log("No token found in localStorage"),e.a(2,{data:null,isLoading:!1});case 1:return e.n=2,fetch("https://nkamdar-ai-book-hackathon.hf.space/api/auth/session",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+n}});case 2:if(!(r=e.v).ok){e.n=4;break}return e.n=3,r.json();case 3:return a=e.v,console.log("Session check successful:",a),e.a(2,{data:a,isLoading:!1});case 4:return console.log("Session check failed with status:",r.status),localStorage.removeItem("better_auth_token"),e.a(2,{data:null,isLoading:!1});case 5:e.n=7;break;case 6:return e.p=6,s=e.v,console.error("Session check failed:",s),localStorage.removeItem("better_auth_token"),e.a(2,{data:null,isLoading:!1});case 7:return e.a(2)}},e,null,[[0,6]])}));return function(){return e.apply(this,arguments)}}(),m=function(){return{session:null,loading:!1}}},9800:(e,n,r)=>{r.r(n),r.d(n,{default:()=>m});var a=r(2444),s=r(467),o=r(6540),t=r(6907),i=r(7940),c=r(3689),l=r(4848);const u=function(e){var n=e.onSuccess,r=e.onError,t=(0,o.useState)({name:"",email:"",password:"",confirmPassword:""}),u=t[0],d=t[1],m=(0,o.useState)(!1),h=m[0],p=m[1],f=(0,o.useState)({}),g=f[0],v=f[1],w=(0,c.useAuth)().refreshSession,k=function(e){var n,r;(d(Object.assign({},u,((n={})[e.target.name]=e.target.value,n))),g[e.target.name])&&v(Object.assign({},g,((r={})[e.target.name]="",r)))},S=function(){var e={};return u.name.trim()||(e.name="Name is required"),u.email.trim()?/\S+@\S+\.\S+/.test(u.email)||(e.email="Email is invalid"):e.email="Email is required",u.password?u.password.length<8&&(e.password="Password must be at least 8 characters"):e.password="Password is required",u.password!==u.confirmPassword&&(e.confirmPassword="Passwords do not match"),v(e),0===Object.keys(e).length},A=function(){var e=(0,s.A)((0,a.A)().m(function e(s){var o,t,c;return(0,a.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(s.preventDefault(),S()){e.n=1;break}return e.a(2);case 1:return p(!0),v({}),e.p=2,e.n=3,i.y.register(u.email,u.password,u.name);case 3:if(null==(o=e.v)||!o.error){e.n=4;break}v({general:o.error.message||"An error occurred during signup"}),e.n=6;break;case 4:if(!n){e.n=6;break}if(!w){e.n=5;break}return e.n=5,w();case 5:console.log("Signup successful, redirecting..."),n();case 6:e.n=8;break;case 7:e.p=7,c=e.v,console.error("Signup error:",c),t=c.message||"An error occurred during signup",v({general:t}),r&&r(t);case 8:return e.p=8,p(!1),e.f(8);case 9:return e.a(2)}},e,null,[[2,7,8,9]])}));return function(n){return e.apply(this,arguments)}}();return(0,l.jsxs)("div",{className:"signup-form",children:[(0,l.jsx)("h2",{children:"Sign Up"}),g.general&&(0,l.jsx)("div",{className:"alert alert-error",children:g.general}),(0,l.jsxs)("form",{onSubmit:A,children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"name",children:"Name"}),(0,l.jsx)("input",{type:"text",id:"name",name:"name",value:u.name,onChange:k,className:"form-control "+(g.name?"is-invalid":""),placeholder:"Enter your name"}),g.name&&(0,l.jsx)("div",{className:"error-message",children:g.name})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"email",children:"Email"}),(0,l.jsx)("input",{type:"email",id:"email",name:"email",value:u.email,onChange:k,className:"form-control "+(g.email?"is-invalid":""),placeholder:"Enter your email"}),g.email&&(0,l.jsx)("div",{className:"error-message",children:g.email})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"password",children:"Password"}),(0,l.jsx)("input",{type:"password",id:"password",name:"password",value:u.password,onChange:k,className:"form-control "+(g.password?"is-invalid":""),placeholder:"Enter your password"}),g.password&&(0,l.jsx)("div",{className:"error-message",children:g.password})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"confirmPassword",children:"Confirm Password"}),(0,l.jsx)("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:u.confirmPassword,onChange:k,className:"form-control "+(g.confirmPassword?"is-invalid":""),placeholder:"Confirm your password"}),g.confirmPassword&&(0,l.jsx)("div",{className:"error-message",children:g.confirmPassword})]}),(0,l.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:h,children:h?"Signing up...":"Sign Up"})]})]})};var d=r(6347);const m=function(){(0,d.W6)();var e=function(){var e=(0,s.A)((0,a.A)().m(function e(){return(0,a.A)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,new Promise(function(e){return setTimeout(e,300)});case 1:window.location.href="/";case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}();return(0,l.jsx)(t.A,{title:"Sign Up",description:"Create a new account",children:(0,l.jsx)("div",{className:"container margin-vert--lg",children:(0,l.jsx)("div",{className:"row",children:(0,l.jsxs)("div",{className:"col col--6 col--offset-3",children:[(0,l.jsx)(u,{onSuccess:e,onError:function(e){console.error("Signup error:",e)}}),(0,l.jsxs)("div",{className:"margin-top--md",children:["Already have an account? ",(0,l.jsx)("a",{href:"/login",children:"Sign in here"})]})]})})})})}}}]);