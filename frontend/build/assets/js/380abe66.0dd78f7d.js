"use strict";(self.webpackChunkai_book_hackathon=self.webpackChunkai_book_hackathon||[]).push([[5216],{6907:(e,n,r)=>{r.d(n,{A:()=>s});r(6540);var t=r(9211),o=r(4848);const s=function(e){var n=e.children,r=e.title,s=e.description;return(0,o.jsx)(t.A,{title:r,description:s,wrapperClassName:"auth-layout",children:(0,o.jsx)("div",{className:"auth-page",style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#0D0D0D"},children:(0,o.jsx)("div",{style:{width:"100%",maxWidth:"500px",margin:"0 auto",padding:"2rem"},children:n})})})}},7940:(e,n,r)=>{r.d(n,{y:()=>h});var t,o,s,a,i=r(2444),l=r(467),c=r(9720),u=function(e){"undefined"!=typeof window&&localStorage.setItem("better_auth_token",e)},d=function(){"undefined"!=typeof window&&localStorage.removeItem("better_auth_token")},h={register:(a=(0,l.A)((0,i.A)().m(function e(n,r,t){var o,s,a;return(0,i.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:return console.log("Auth Service: Starting registration for email:",n),e.p=1,e.n=2,c.signUp.email({email:n,password:r,name:t});case 2:return o=e.v,console.log("Auth Service: Registration response:",o),s=null,o&&o.session&&o.session.token?s=o.session.token:o&&o.token?s=o.token:o&&o.data&&o.data.session&&o.data.session.token?s=o.data.session.token:o&&o.data&&o.data.token&&(s=o.data.token),s?(u(s),console.log("Auth Service: Token stored in localStorage")):(console.log("Auth Service: No token found in response"),console.log("Response structure:",JSON.stringify(o,null,2))),e.a(2,o);case 3:throw e.p=3,a=e.v,console.error("Registration error:",a),a;case 4:return e.a(2)}},e,null,[[1,3]])})),function(e,n,r){return a.apply(this,arguments)}),login:(s=(0,l.A)((0,i.A)().m(function e(n,r){var t,o,s;return(0,i.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:return console.log("Auth Service: Starting login for email:",n),e.p=1,e.n=2,c.signIn.email({email:n,password:r});case 2:return t=e.v,console.log("Auth Service: Login response:",t),o=null,t&&t.session&&t.session.token?o=t.session.token:t&&t.token?o=t.token:t&&t.data&&t.data.session&&t.data.session.token?o=t.data.session.token:t&&t.data&&t.data.token&&(o=t.data.token),o?(u(o),console.log("Auth Service: Token stored in localStorage")):(console.log("Auth Service: No token found in response"),console.log("Response structure:",JSON.stringify(t,null,2))),e.a(2,t);case 3:throw e.p=3,s=e.v,console.error("Login error:",s),s;case 4:return e.a(2)}},e,null,[[1,3]])})),function(e,n){return s.apply(this,arguments)}),logout:(o=(0,l.A)((0,i.A)().m(function e(){var n,r;return(0,i.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,(0,c.signOut)();case 1:return n=e.v,d(),e.a(2,n);case 2:throw e.p=2,r=e.v,console.error("Logout error:",r),r;case 3:return e.a(2)}},e,null,[[0,2]])})),function(){return o.apply(this,arguments)}),getCurrentUser:(t=(0,l.A)((0,i.A)().m(function e(){return(0,i.A)().w(function(e){for(;;)if(0===e.n)return e.a(2)},e)})),function(){return t.apply(this,arguments)})}},9185:(e,n,r)=>{r.r(n),r.d(n,{default:()=>h});var t=r(2444),o=r(467),s=r(6540),a=r(6907),i=r(7940),l=r(3689),c=r(4848);const u=function(e){var n=e.onSuccess,r=e.onError,a=(0,s.useState)({email:"",password:""}),u=a[0],d=a[1],h=(0,s.useState)(!1),p=h[0],m=h[1],f=(0,s.useState)({}),g=f[0],v=f[1],k=(0,l.useAuth)().refreshSession,w=function(e){var n,r;(d(Object.assign({},u,((n={})[e.target.name]=e.target.value,n))),g[e.target.name])&&v(Object.assign({},g,((r={})[e.target.name]="",r)))},S=function(){var e={};return u.email.trim()?/\S+@\S+\.\S+/.test(u.email)||(e.email="Email is invalid"):e.email="Email is required",u.password||(e.password="Password is required"),v(e),0===Object.keys(e).length},A=function(){var e=(0,o.A)((0,t.A)().m(function e(o){var s,a,l;return(0,t.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(o.preventDefault(),S()){e.n=1;break}return e.a(2);case 1:return m(!0),v({}),e.p=2,e.n=3,i.y.login(u.email,u.password);case 3:if(null==(s=e.v)||!s.error){e.n=4;break}v({general:s.error.message||"Invalid email or password"}),e.n=6;break;case 4:if(!n){e.n=6;break}if(!k){e.n=5;break}return e.n=5,k();case 5:console.log("Login successful, redirecting..."),n();case 6:e.n=8;break;case 7:e.p=7,l=e.v,console.error("Login error:",l),a=l.message||"Invalid email or password",v({general:a}),r&&r(a);case 8:return e.p=8,m(!1),e.f(8);case 9:return e.a(2)}},e,null,[[2,7,8,9]])}));return function(n){return e.apply(this,arguments)}}();return(0,c.jsxs)("div",{className:"login-form",children:[(0,c.jsx)("h2",{children:"Sign In"}),g.general&&(0,c.jsx)("div",{className:"alert alert-error",children:g.general}),(0,c.jsxs)("form",{onSubmit:A,children:[(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{htmlFor:"email",children:"Email"}),(0,c.jsx)("input",{type:"email",id:"email",name:"email",value:u.email,onChange:w,className:"form-control "+(g.email?"is-invalid":""),placeholder:"Enter your email"}),g.email&&(0,c.jsx)("div",{className:"error-message",children:g.email})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{htmlFor:"password",children:"Password"}),(0,c.jsx)("input",{type:"password",id:"password",name:"password",value:u.password,onChange:w,className:"form-control "+(g.password?"is-invalid":""),placeholder:"Enter your password"}),g.password&&(0,c.jsx)("div",{className:"error-message",children:g.password})]}),(0,c.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:p,children:p?"Signing in...":"Sign In"})]})]})};var d=r(6347);const h=function(){(0,d.W6)();var e=function(){var e=(0,o.A)((0,t.A)().m(function e(){return(0,t.A)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,new Promise(function(e){return setTimeout(e,300)});case 1:window.location.href="/";case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}();return(0,c.jsx)(a.A,{title:"Sign In",description:"Sign in to your account",children:(0,c.jsx)("div",{className:"container margin-vert--lg",children:(0,c.jsx)("div",{className:"row",children:(0,c.jsxs)("div",{className:"col col--6 col--offset-3",children:[(0,c.jsx)(u,{onSuccess:e,onError:function(e){console.error("Login error:",e)}}),(0,c.jsxs)("div",{className:"margin-top--md",children:["Don't have an account? ",(0,c.jsx)("a",{href:"/signup",children:"Sign up here"})]})]})})})})}},9720:(e,n,r)=>{r.r(n),r.d(n,{authClient:()=>u,checkSession:()=>d,signIn:()=>i,signOut:()=>c,signUp:()=>l,useSession:()=>h});var t,o,s=r(2444),a=r(467),i={email:(t=(0,a.A)((0,s.A)().m(function e(n){var r,t,o,a;return(0,s.A)().w(function(e){for(;;)switch(e.n){case 0:return r=n.email,t=n.password,e.n=1,fetch("http://localhost:8000/api/auth/sign-in/email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,password:t})});case 1:return o=e.v,e.n=2,o.json();case 2:if(a=e.v,!o.ok){e.n=3;break}return a.session&&a.session.token&&localStorage.setItem("better_auth_token",a.session.token),e.a(2,a);case 3:throw new Error(a.detail||"Login failed");case 4:return e.a(2)}},e)})),function(e){return t.apply(this,arguments)})},l={email:(o=(0,a.A)((0,s.A)().m(function e(n){var r,t,o,a,i;return(0,s.A)().w(function(e){for(;;)switch(e.n){case 0:return r=n.email,t=n.password,o=n.name,e.n=1,fetch("http://localhost:8000/api/auth/sign-up/email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,password:t,name:o||""})});case 1:return a=e.v,e.n=2,a.json();case 2:if(i=e.v,!a.ok){e.n=3;break}return i.session&&i.session.token&&localStorage.setItem("better_auth_token",i.session.token),e.a(2,i);case 3:throw new Error(i.detail||"Registration failed");case 4:return e.a(2)}},e)})),function(e){return o.apply(this,arguments)})},c=function(){var e=(0,a.A)((0,s.A)().m(function e(){var n;return(0,s.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:return localStorage.removeItem("better_auth_token"),e.p=1,e.n=2,fetch("http://localhost:8000/api/auth/sign-out",{method:"POST"});case 2:e.n=4;break;case 3:e.p=3,n=e.v,console.error("Sign out error:",n);case 4:return e.a(2,{success:!0})}},e,null,[[1,3]])}));return function(){return e.apply(this,arguments)}}(),u=null,d=function(){var e=(0,a.A)((0,s.A)().m(function e(){var n,r,t,o;return(0,s.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,n=localStorage.getItem("better_auth_token")||""){e.n=1;break}return console.log("No token found in localStorage"),e.a(2,{data:null,isLoading:!1});case 1:return e.n=2,fetch("http://localhost:8000/api/auth/session",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+n}});case 2:if(!(r=e.v).ok){e.n=4;break}return e.n=3,r.json();case 3:return t=e.v,console.log("Session check successful:",t),e.a(2,{data:t,isLoading:!1});case 4:return console.log("Session check failed with status:",r.status),localStorage.removeItem("better_auth_token"),e.a(2,{data:null,isLoading:!1});case 5:e.n=7;break;case 6:return e.p=6,o=e.v,console.error("Session check failed:",o),localStorage.removeItem("better_auth_token"),e.a(2,{data:null,isLoading:!1});case 7:return e.a(2)}},e,null,[[0,6]])}));return function(){return e.apply(this,arguments)}}(),h=function(){return{session:null,loading:!1}}}}]);